<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Official site of the Astral Pirates. Join us for galactic mischief, dancing, and building a better world!" />
  <meta name="theme-color" content="#000000" />
  <title>astralpirates.com</title>

  <!-- Performance: use link instead of @import for fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Special+Elite&display=swap" rel="stylesheet" />

  <link rel="icon" type="image/png" href="logo.png" />

  <style>
    :root {
      --gradient: linear-gradient(90deg, violet, blue, cyan, lime, yellow, orange, red, violet);
    }

    * { box-sizing: border-box; }

    html, body {
      height: 100%;
    }

    body {
      margin: 0;
      background: #000; /* keep solid black behind the cube map */
      overflow: hidden; /* avoids scrollbars with the canvas */
      font-family: 'Special Elite', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      color: #fff;
      animation: fadeIn 800ms ease-in both;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    a { text-decoration: none; font-weight: 700; color: #fff; }
    a:hover { text-shadow: 0 0 8px rgba(255,255,255,.8); }

    /* Skip link for keyboard users */
    .skip-link {
      position: absolute; left: 8px; top: -40px; z-index: 9999;
      background: #111; color: #fff; padding: 8px 12px; border-radius: 8px;
      transition: top .2s;
    }
    .skip-link:focus { top: 8px; }

    header#title {
      position: absolute; inset-inline: 0; top: 16px; z-index: 10;
      display: flex; justify-content: center; align-items: center; gap: 10px;
      text-align: center; font-size: clamp(20px, 3.2vw, 36px);
      background: var(--gradient);
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; color: transparent;
      padding-inline: 12px;
    }
    #title img { inline-size: 40px; block-size: 40px; filter: drop-shadow(0 0 6px rgba(255,255,255,.25)); }

    main#content {
      position: absolute; z-index: 10; inset-inline: 5%; inline-size: 90%;
      top: 28%; text-align: center;
      font-size: clamp(14px, 2.6vw, 20px);
      background: var(--gradient);
      -webkit-background-clip: text; background-clip: text;
      -webkit-text-fill-color: transparent; color: transparent;
    }

    .cta { margin-top: 14px; display: inline-block; padding: 10px 14px; border-radius: 999px; border: 2px solid rgba(255,255,255,.5); }
    .cta:focus-visible { outline: 3px solid #fff; outline-offset: 3px; }

    /* QR anchors */
    .qr-container {
      position: absolute; bottom: 20px; inline-size: 100px; z-index: 10; text-align: center;
      font-size: 14px; line-height: 1.2;
    }
    .qr-container img { inline-size: 100px; block-size: 100px; display: block; margin: 0 auto 6px; border-radius: 12px; }
    #donate-container { left: 20px; }
    #enlist-container { right: 20px; }
    .qr-label { color: #fff; text-shadow: 0 0 10px rgba(255,255,255,.5); }

    /* Responsive tweaks */
    @media (max-width: 600px) {
      main#content { inset-inline: 5%; inline-size: 90%; top: 30%; }
      .qr-container { inline-size: 88px; }
      .qr-container img { inline-size: 88px; block-size: 88px; }
    }

    /* Respect user motion preferences */
    @media (prefers-reduced-motion: reduce) {
      body { animation: none; }
    }

    /* Canvas element fills the viewport under the UI */
    canvas#bg {
      position: fixed; inset: 0; z-index: 0; display: block; /* no scroll gap */
    }

    /* Noscript fallback */
    .fallback {
      position: fixed; inset: 0; display: grid; place-items: center; padding: 24px; background: #000; color: #fff; z-index: 1;
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#content">Skip to content</a>

  <header id="title" role="banner">
    <img src="logo.png" alt="Astral Pirates logo" loading="lazy" decoding="async" />
    <div aria-label="astralpirates dot com">astralpirates.com</div>
  </header>

  <main id="content" role="main">
    <p>grrrretings priats!!</p>
    <p>All the love to all who joined the crew!</p>
    <p>
      Meet Captain Roger and Elsa at Basislager after the Parade!
    </p>

    <p>
      <a class="cta" href="https://www.twitch.tv/astralpirates" target="_blank" rel="noopener" aria-label="Dance with E.L.S.A. and the pirates on Twitch">
        Dance with E.L.S.A. and the pirates
      </a>
    </p>
  </main>

  <!-- QR: Donate (Bitcoin) -->
  <a
    href="bitcoin:bc1q7crgdxshv87jlfzput0c0xlnkjatzc9uqe348a"
    target="_blank"
    rel="noopener"
    class="qr-container"
    id="donate-container"
    aria-label="Donate via Bitcoin QR"
  >
    <img src="donate.png" alt="Donate QR" loading="lazy" decoding="async" />
    <div class="qr-label">Donate</div>
  </a>

  <!-- QR: Enlist -->
  <a
    href="mailto:enlist@astralpirates.com"
    class="qr-container"
    id="enlist-container"
    aria-label="Enlist via email"
  >
    <img src="enlist.png" alt="Enlist QR" loading="lazy" decoding="async" />
    <div class="qr-label">Enlist</div>
  </a>

  <!-- Three.js background -->
  <canvas id="bg" aria-hidden="true"></canvas>

  <noscript>
    <div class="fallback">
      <p>JavaScript is disabled. You can still access our links above. Enable JavaScript to see the animated galaxy background.</p>
    </div>
  </noscript>

  <script src="https://cdn.jsdelivr.net/npm/three@0.149.0/build/three.min.js" integrity="sha384-U9cJqqvt3M5z+0FPI2VwKGv9yGrJS0c+0MFmV7K3TzJk1e5SgCzYw0VvQZbC9d3b" crossorigin="anonymous"></script>
  <script>
    (() => {
      const canvas = document.getElementById('bg');
      const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
      renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
      renderer.setSize(window.innerWidth, window.innerHeight);

      const scene = new THREE.Scene();

      // Starfield cubemap background
      const loader = new THREE.CubeTextureLoader();
      loader.setPath('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/cube/MilkyWay/');
      const bg = loader.load(
        ['dark-s_px.jpg', 'dark-s_nx.jpg', 'dark-s_py.jpg', 'dark-s_ny.jpg', 'dark-s_pz.jpg', 'dark-s_nz.jpg'],
        () => { /* loaded */ },
        undefined,
        (err) => { console.warn('Cube texture failed to load', err); }
      );
      scene.background = bg;

      const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
      camera.position.z = 6;

      scene.add(new THREE.AmbientLight(0x404040));
      const light = new THREE.PointLight(0xffffff, 1);
      light.position.set(10, 10, 10);
      scene.add(light);

      const material = new THREE.ShaderMaterial({
        uniforms: {
          color1: { value: new THREE.Color(0x5500ff) },
          color2: { value: new THREE.Color(0xff0066) }
        },
        vertexShader: `
          varying vec3 vPosition;
          void main() {
            vPosition = position;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
          }
        `,
        fragmentShader: `
          uniform vec3 color1;
          uniform vec3 color2;
          varying vec3 vPosition;
          void main() {
            float pct = (vPosition.y + 2.0) / 4.0;
            gl_FragColor = vec4(mix(color1, color2, clamp(pct, 0.0, 1.0)), 1.0);
          }
        `,
        side: THREE.DoubleSide
      });

      const geometry = new THREE.TetrahedronGeometry(2);
      const tetrahedron = new THREE.Mesh(geometry, material);
      scene.add(tetrahedron);

      const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      let rafId;
      function render() {
        tetrahedron.rotation.y += reduceMotion ? 0.002 : 0.01;
        tetrahedron.rotation.x += reduceMotion ? 0.001 : 0.005;
        renderer.render(scene, camera);
      }

      function animate() {
        render();
        rafId = requestAnimationFrame(animate);
      }

      function onResize() {
        const w = window.innerWidth, h = window.innerHeight;
        renderer.setSize(w, h);
        camera.aspect = w / h;
        camera.updateProjectionMatrix();
      }

      window.addEventListener('resize', onResize, { passive: true });

      // Handle tab visibility to save battery
      document.addEventListener('visibilitychange', () => {
        if (document.hidden) {
          cancelAnimationFrame(rafId);
        } else {
          animate();
        }
      });

      animate();

      // Cleanup when navigating away (in single-page contexts)
      window.addEventListener('beforeunload', () => cancelAnimationFrame(rafId));
    })();
  </script>
</body>
</html>
